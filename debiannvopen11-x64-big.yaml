#==============================================================================
# vim: softtabstop=2 shiftwidth=2 expandtab fenc=utf-8 cc=81 tw=80
#==============================================================================
#
# DESCRIPTION: Debian bullseye (11) x64 big Grid'5000 environment
#
#==============================================================================
---
extend: ./debian11-x64-common.yaml

global:
  g5k_distrib: $${distrib}nvopen
  g5k_description: $${distrib} $${release_number} ($${release}) with nvidia open kernel modules for $${arch} - $${g5k_variant}

  # Grid'5000 environment variant
  g5k_variant: big
  # Grid'5000 Kadeploy environment parameters
  g5k_postinst_script: g5k-postinstall --net debian --net hpc --fstab nfs --fstab ondemand --restrict-user current --disk-aliases
  # QEMU options
  image_size: 28G
  # nvidia module licence
  nvidia_module: open

bootstrap:
  - "@base"

setup:
  - "@base"
  - last_tweaks:
    - fix_env_name:
      - exec_in: |
          sed -i -e '1s/^$${distrib}$${release_number}-/$${g5k_distrib}$${release_number}-/' /etc/grid5000/release
    - change_motd:
      - exec_in: |
          sed -i \
              -e 's/^Debian$${release_number}-/Debiannvopen$${release_number}-/' \
              /etc/motd

export:
  - "@base"
